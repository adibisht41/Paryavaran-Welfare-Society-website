/*
Copyright 2010 Google Inc.
Copyright 2016 Akamai Technolgies

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

See the source code here:
     http://code.google.com/p/episodes/
*/


!function(e){e.parent!==e&&void 0==e.AKSB&&(e=e.parent);var t=e.document;"undefined"==typeof e.AKSB&&(e.AKSB={});var n=e.AKSB;void 0!=n.prof&&n.prof.origin===!0&&("number"!=typeof n.prof.beaconrate&&(n.prof.beaconrate=10),parseInt(n.prof.beaconrate,10)<=100*Math.random())||(n.q=n.q||[],n.autorun="undefined"==typeof n.autorun||n.autorun,n.version||"X"===e.AKSB.prof.akTT||(n.version=11,n.init=function(){n.bDone=!1,n.marks={},n.measures={},n.starts={},n.getClientProf(),n.processQ();var e=n.findStartWebTiming();e&&(n.mark("starttime",e),n.addEventListener("DOMContentLoaded",n.onready,!1),n.addEventListener("load",n.onload,!1),"complete"===t.readyState&&(n.onloadHasFired=!0,window.setTimeout(n.onload,1)),n.processQ())},n.processQ=function(){for(var e=n.q.length,t=0;t<e;t++){var r=n.q[t],o=r[0];"mark"===o?n.mark(r[1],r[2]):"measure"===o?n.measure(r[1],r[2],r[3]):"done"===o&&n.done(r[1])}},n.getClientProf=function(){n.prof=n.prof||{},n.prof.ipv6=n.prof.ipv6===!0||"true"===n.prof.ipv6,n.prof.beaconUrl=n.prof.beaconUrl||("https:"===t.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/2/"+n.prof.custid+"/b",n.prof.ua=escape(e.navigator.userAgent),n.prof.plat=escape(e.navigator.platform),n.prof.uri=escape(t.location.protocol.toLowerCase()+"//"+t.location.hostname.toLowerCase()+t.location.pathname);var r=e.navigator.connection||e.navigator.mozConnection||e.navigator.webkitConnection,o="",a="";if(r&&"number"==typeof r.type?r.type==r.WIFI?(o="wifi",a=7e6):r.type==r.CELL_2G?(o="cellular",a=384):r.type==r.CELL_3G?(o="cellular",a=42e3):r.type==r.CELL_4G?(o="cellular",a=1e5):r.type==r.ETHERNET?(o="ethernet",a=1e7):r.type==r.NONE?(o="none",a=0):o="unknown":r&&"string"==typeof r.type&&(o=r.type,r.downlinkMax&&(a=Math.round(1e3*r.downlinkMax))),n.prof.connType=escape(o),n.prof.connBandwidth=a,n.prof.pageViz=t.visibilityState||t.webkitVisibilityState||t.mozVisibilityState||t.msVisibilityState,n.prof.feo="undefined"!=typeof e.aFeoApplied,n.prof.qryTrunc=""!==t.location.search,n.prof.pct){var i=!(parseInt(n.prof.pct,10)<=100*Math.random());if(i&&void 0!==n.prof.clientip){var s=n.getMangledAddress(),p=n.prof.ipv6?"j":"i";n.prof.beaconUrl=("https:"===t.location.protocol?"https:":"http:")+"//"+p+s+"-ds-aksb-a.akamaihd.net/2/"+n.prof.custid+"/b"}}},n.getMangledAddress=function(){if(void 0===n.prof.clientip)return"";if(n.prof.ipv6){var e=n.prof.clientip.split(":");return(""==e[0]?"":parseInt(e[0],16).toString(32))+"z"+(""==e[1]?"":parseInt(e[1],16).toString(32))+"z"+(""==e[2]?"":parseInt(e[2],16).toString(32))}var e=n.prof.clientip.split(".");return("00000000"+(256*(256*(256*+e[0]+ +e[1])+ +e[2])+0).toString(16)).slice(-8)},n.mark=function(e,t){e&&(n.marks[e]=parseInt(t||(new Date).getTime(),10),"firstbyte"===e?n.measure("t_fb","starttime","firstbyte"):"onload"===e?n.measure("t_onload","starttime","onload"):"done"===e&&n.measure("t_plt","starttime","done"))},n.measure=function(e,t,r){if(e){var o;if("undefined"==typeof t)o="number"==typeof n.marks[e]?n.marks[e]:(new Date).getTime();else if("number"==typeof n.marks[t])o=n.marks[t];else{if("number"!=typeof t)return;o=t}var a;if("undefined"==typeof r)a=(new Date).getTime();else if("number"==typeof n.marks[r])a=n.marks[r];else{if("number"!=typeof r)return;a=r}n.starts[e]=parseInt(o,10),n.measures[e]=parseInt(a-o,10)}},n.done=function(t){n.mark("done");var r=function(){n.bDone=!0,n.autorun&&n.sendBeacon(),"function"==typeof t&&t()},o=n.getNavTimingAPI(),a=o.navigation,i=o.timing;if(void 0!==o){var s=function(){for(var t in i)n.mark(t,i[t]);if(n.measure("dE","domainLookupStart","domainLookupEnd"),n.measure("cS","domainLookupStart","connectStart"),i.secureConnectionStart&&n.measure("sS","domainLookupStart","secureConnectionStart"),n.measure("cE","domainLookupStart","connectEnd"),n.measure("rqS","domainLookupStart","requestStart"),n.measure("rsS","domainLookupStart","responseStart"),n.measure("rsE","domainLookupStart","responseEnd"),i.msFirstPaint)n.measure("fp","navigationStart","msFirstPaint");else if("undefined"!=typeof e.chrome&&e.chrome.hasOwnProperty("loadTimes")){var o=Math.round(1e3*e.chrome.loadTimes().firstPaintTime);o>0&&n.measure("fp","domainLookupStart",o)}n.measure("dl","domainLookupStart","domLoading"),n.measure("di","domainLookupStart","domInteractive"),n.measure("dlS","domainLookupStart","domContentLoadedEventStart"),n.measure("dlE","domainLookupStart","domContentLoadedEventEnd"),n.measure("dc","domainLookupStart","domComplete"),n.measure("leS","domainLookupStart","loadEventStart"),n.measure("leE","domainLookupStart","loadEventEnd"),r()},p=function(){a&&(0===a.type||1===a.type)&&i&&i.loadEventEnd>0?s():i&&i.loadEventEnd<=0&&setTimeout(p,100)};p()}},n.aksbVersion=function(){return""+(void 0===n.prof.blver?0:n.prof.blver)+":"+(void 0===n.version?0:n.version)},n.sendBeacon=function(e,t){e=e||n.prof.beaconUrl;var r=(n.measures,"");n.bf=n.bitField(),n.createBitField();var o={dE:n.measures.dE,cS:n.measures.cS,cE:n.measures.cE,rqS:n.measures.rqS,rsS:"undefined"!=typeof n.measures.rsS?n.measures.rsS:n.measures.t_fb,rsE:n.measures.rsE,sS:n.measures.sS,dl:n.measures.dl,di:n.measures.di,fp:n.measures.fp,dlS:n.measures.dlS,dlE:"undefined"!=typeof n.measures.dlE?n.measures.dlE:n.measures.t_onready,dc:n.measures.dc,leS:"undefined"!=typeof n.measures.leS?n.measures.leS:n.measures.t_onload,leE:"undefined"!=typeof n.measures.leE?n.measures.leE:n.measures.t_plt,to:n.measures.to,ol:n.prof.originlat,cr:n.prof.clientrtt,mt:n.prof.connType,mb:n.prof.connBandwidth,b:n.bf.get(),u:n.prof.uri,ua:n.prof.ua,pl:n.prof.plat,us:n.prof.ustr,gh:n.prof.ghostip,t:n.prof.token,rid:n.prof.requestid,r:n.prof.region,akM:n.prof.akM,akN:n.prof.akN,vc:n.aksbVersion(),bpcip:n.getMangledAddress(),akTX:n.prof.akTX,akTI:n.prof.akTI,ai:n.prof.ai,pmgn:n.prof.pmgn,pmgi:n.prof.pmgi,pmp:n.prof.pmp};if(o)for(var a in o)r+="&"+escape(a)+"="+("undefined"==typeof o[a]?"":o[a]);if(r){if(r=r.substring(1),t)for(var i in t)t.hasOwnProperty(i)&&(r+="&"+escape(i)+"="+escape(t[i]));var s=(n.bf.get(),new Image);return s.src=e+"?"+r,s.src}return""},n.bitField=function(e){var t=Math.abs(e),n=function(){};return n.prototype.set=function(e){return this.hasbit(e)?t:t|=e},n.prototype.hasbit=function(e){return e>t?0:t&e},n.prototype.get=function(){return t},new n},n.createBitField=function(){var e={MS_NT:1,IPv6:16,FEO:32,VIA_SPDY:64,VIS_HIDDEN:128,VIS_VISIBLE:256,VIS_PRERENDERED:512,QUERY_TRUNCATED:2048,RUM_AT_ORIGIN:4096,ONLOAD_HAS_FIRED:8192,VIA_HTTP_TWO:131072,TXN_ENABLED:262144,RUA_APPLIED:524288,VIA_QUIC:1048576};n.bf.set(e.MS_NT);var t=n.prof.protocol;void 0!==t&&("h2"==t.slice(0,2)?n.bf.set(e.VIA_HTTP_TWO):"spdy"==t.slice(0,4)&&n.bf.set(e.VIA_SPDY));var r=n.prof.qc;"string"==typeof r&&""!==r&&"0"!==r&&n.bf.set(e.VIA_QUIC),n.prof.ipv6&&n.bf.set(e.IPv6),n.prof.feo&&n.bf.set(e.FEO),"hidden"===n.prof.pageViz&&n.bf.set(e.VIS_HIDDEN),"visible"===n.prof.pageViz&&n.bf.set(e.VIS_VISIBLE),"prerendered"===n.prof.pageViz&&n.bf.set(e.VIS_PRERENDERED),n.prof.qryTrunc&&n.bf.set(e.QUERY_TRUNCATED),n.prof.origin===!0&&n.bf.set(e.RUM_AT_ORIGIN),n.onloadHasFired===!0&&n.bf.set(e.ONLOAD_HAS_FIRED),"true"===n.prof.ra&&n.bf.set(e.RUA_APPLIED),n.prof.akTT&&"O"!=n.prof.akTT&&n.bf.set(e.TXN_ENABLED)},n.findStartWebTiming=function(){var e=void 0,t=n.getNavTimingAPI();return"undefined"!=typeof t&&"undefined"!=typeof t.timing&&"undefined"!=typeof t.timing.navigationStart&&(e=n.prof.ua.match(/Firefox\/[78]\./i)?t.timing.unloadEventStart||t.timing.fetchStart:t.timing.navigationStart,n.prof.src="nt"),e},n.onready=function(e){n.mark("onready",(new Date).getTime()),n.measure("t_onready","starttime","onready")},n.onload=function(e){n.mark("onload",(new Date).getTime()),n.autorun&&n.done()},n.addEventListener=function(t,n,r){return"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener?e.addEventListener(t,n,r):void 0},n.getNavTimingAPI=function(){return e.performance||e.mozPerformance||e.msPerformance||e.webkitPerformance},n.init()))}(window),function(e){function t(){this.data={},this.value=[]}e.parent!==e&&void 0==e.AKSB&&(e=e.parent);var n=e.document;"undefined"==typeof e.RT&&(e.RT={});var r=e.RT;if(!r.version&&"undefined"!=typeof e.AKSB.version&&void 0!==Object.keys){r.version="0.2",r.init=function(){"complete"===n.readyState?window.setTimeout(r.getW3CTimings,1):r.addEventListener("load",r.getW3CTimings,!1)},r.getW3CTimings=function(){var o=new t,a=r.getResourceTimingAPI();for(var i in a)"undefined"!=typeof a[i].duration&&o.insert(a[i].name,[Math.round(a[i].redirectStart),Math.round(a[i].redirectEnd),Math.round(a[i].fetchStart),Math.round(a[i].domainLookupStart),Math.round(a[i].domainLookupEnd),Math.round(a[i].connectStart),Math.round(a[i].connectEnd),Math.round(a[i].secureConnectionStart),Math.round(a[i].requestStart),Math.round(a[i].responseStart),Math.round(a[i].responseEnd),Math.round(a[i].duration),a[i].initiatorType,a[i].nextHopProtocol,a[i].transferSize,a[i].encodedBodySize,a[i].decodedBodySize]);r.radtree=o,r.baseurl=n.location.protocol.toLowerCase()+"//"+n.location.hostname.toLowerCase()+n.location.pathname;var s=function(t){var n=new XMLHttpRequest;n.open("POST",("https:"===e.document.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/RRT",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var o={nt:escape(JSON.stringify(t)),rt:escape(JSON.stringify(r.radtree.data)),rid:e.AKSB.prof.requestid,gh:e.AKSB.prof.ghostip,b:e.AKSB.bf.get(),c:e.AKSB.prof.custid,us:e.AKSB.prof.ustr,ol:e.AKSB.prof.originlat,cr:e.AKSB.prof.clientrtt,ua:e.AKSB.prof.ua,pl:e.AKSB.prof.plat,mt:e.AKSB.prof.connType,mb:e.AKSB.prof.connBandwidth,vc:e.AKSB.aksbVersion(),bpcip:e.AKSB.getMangledAddress(),akTX:e.AKSB.akTX,akTI:e.AKSB.akTI,ai:e.AKSB.prof.ai},a=[];for(var i in o)o.hasOwnProperty(i)&&o[i]&&a.push(i+"="+o[i]);n.send(a.join("&"))},p=e.performance&&e.performance.timing;if(p){var d=e.performance.timing,u=function(){if(d.loadEventEnd>0){var t=[d.domainLookupEnd-d.domainLookupStart,d.connectStart-d.domainLookupStart,d.connectEnd-d.domainLookupStart,d.secureConnectionStart?d.secureConnectionStart-d.domainLookupStart:null,d.requestStart-d.domainLookupStart,d.responseStart-d.domainLookupStart,d.responseEnd-d.domainLookupStart,d.domLoading-d.domainLookupStart,d.domInteractive-d.domainLookupStart,d.msFirstPaint?d.msFirstPaint-d.navigationStart:"undefined"!=typeof e.chrome&&e.chrome.hasOwnProperty("loadTimes")?Math.round(1e3*e.chrome.loadTimes().firstPaintTime)-d.domainLookupStart:null,d.domContentLoadedEventStart-d.domainLookupStart,d.domContentLoadedEventEnd-d.domainLookupStart,d.domComplete-d.domainLookupStart,d.loadEventStart-d.domainLookupStart,d.loadEventEnd-d.domainLookupStart],n={};n[r.baseurl]=t,s(n)}else d.loadEventEnd<=0&&setTimeout(u,100)};u()}else{var f=function(){if("AKSB"in e&&"measures"in e.AKSB&&"t_plt"in e.AKSB.measures){var t=[null,null,null,0,null,null,null,null,null,null,null,null,null,e.AKSB.measures.t_onload,e.AKSB.measures.t_plt],n={};n[r.baseurl]=t,s(n)}else setTimeout(f,100)};f()}},r.addEventListener=function(t,n,r){return"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener?e.addEventListener(t,n,r):void 0},r.getResourceTimingAPI=function(){if("performance"in e){if("getEntriesByType"in e.performance)return e.performance.getEntriesByType("resource");if("webkitGetEntriesByType"in e.performance)return e.performance.webkitGetEntriesByType("resource")}return null},t.prototype.insert=function(e,t){for(var n=this.data;e;){var r=this.get_prefix(e,Object.keys(n)),o=r[0],a=r[1];if(!o||"string"!=typeof o||"string"!=typeof a)break;var i=o.length;if(o!==a){var s=a.slice(i,a.length),p=n[a];p===this.value&&(p=JSON.parse(JSON.stringify(p))),n[o]={},n[o][s]=p,delete n[a]}else n[o]===this.value&&(n[o]=JSON.parse(JSON.stringify(this.value)));e=e.slice(i,e.length),n=n[o]}return n[e]=e?t:null,!0},t.prototype.get_prefix=function(e,t){function n(e,t){return e.length<t.length?-1:e.length>t.length?1:0}function r(e,t){return""===t||null!=e&&null!=t&&(e=String(e),t=String(t),e.length>=t.length&&e.slice(0,t.length)===t)}if(t.sort(n),"undefined"!=typeof e){wc=e[0];for(var o in t)if(r(t[o],wc))for(var a=e.length;a>=1;a--)if(r(t[o],e.slice(0,a)))return[e.slice(0,a),t[o]]}return["",null]};var o=e.AKSB.prof.akTT;if(e.performance&&(e.performance.getEntries||e.performance.webkitGetEntries))if("R"===o)r.init();else{if("O"!==o&&void 0!==o||!(e.document.location.search.search("akamai-rum-rt=on")>=0)&&5<=100*Math.random())return;r.init()}}}(window);